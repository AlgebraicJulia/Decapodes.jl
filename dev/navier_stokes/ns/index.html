<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Vortices · Decapodes.jl</title><meta name="title" content="Vortices · Decapodes.jl"/><meta property="og:title" content="Vortices · Decapodes.jl"/><meta property="twitter:title" content="Vortices · Decapodes.jl"/><meta name="description" content="Documentation for Decapodes.jl."/><meta property="og:description" content="Documentation for Decapodes.jl."/><meta property="twitter:description" content="Documentation for Decapodes.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="../../assets/analytics.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Decapodes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Decapodes.jl</a></li><li><a class="tocitem" href="../../overview/overview/">Overview</a></li><li><a class="tocitem" href="../../equations/equations/">Equations</a></li><li class="is-active"><a class="tocitem" href>Vortices</a><ul class="internal"><li><a class="tocitem" href="#Vorticity-Formulation"><span>Vorticity Formulation</span></a></li><li><a class="tocitem" href="#Initial-Conditions"><span>Initial Conditions</span></a></li><li><a class="tocitem" href="#Streamfunction-Poisson-Formulation"><span>Streamfunction-Poisson Formulation</span></a></li><li><a class="tocitem" href="#Phenominological-Assessment"><span>Phenominological Assessment</span></a></li></ul></li><li><a class="tocitem" href="../../harmonics/harmonics/">Harmonics</a></li><li><a class="tocitem" href="../../ch/cahn-hilliard/">Cahn-Hilliard</a></li><li><a class="tocitem" href="../../klausmeier/klausmeier/">Klausmeier</a></li><li><a class="tocitem" href="../../cism/cism/">CISM v2.1</a></li><li><a class="tocitem" href="../../ice_dynamics/ice_dynamics/">Glacial Flow</a></li><li><a class="tocitem" href="../../grigoriev/grigoriev/">Grigoriev Ice Cap</a></li><li><a class="tocitem" href="../../bsh/budyko_sellers_halfar/">Budyko-Sellers-Halfar</a></li><li><a class="tocitem" href="../../ebm_melt/ebm_melt/">Halfar-EBM-Water</a></li><li><a class="tocitem" href="../../halmo/halmo/">Halfar-NS</a></li><li><a class="tocitem" href="../../nhs/nhs_lite/">NHS</a></li><li><a class="tocitem" href="../../poiseuille/poiseuille/">Pipe Flow</a></li><li><a class="tocitem" href="../../bc/bc_debug/">Misc Features</a></li><li><a class="tocitem" href="../../ascii/">ASCII Operators</a></li><li><a class="tocitem" href="../../canon/">Canonical Models</a></li><li><a class="tocitem" href="../../api/">Library Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Vortices</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Vortices</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/Decapodes.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/Decapodes.jl/blob/main/docs/src/navier_stokes/ns.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Navier-Stokes-Vorticity-Model"><a class="docs-heading-anchor" href="#Navier-Stokes-Vorticity-Model">Navier Stokes Vorticity Model</a><a id="Navier-Stokes-Vorticity-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Navier-Stokes-Vorticity-Model" title="Permalink"></a></h1><p><img src="../vort.gif" alt="Rotating point vortices"/></p><p><img src="../taylor_vort.gif" alt="Repelling Taylor vortices"/></p><p>This docs page demonstrates a discretization of the invisicd incompressible Navier Stokes equations using the Discrete Exterior Calculus.</p><p>The formulations are based on those given by <a href="https://arxiv.org/abs/1508.01166">Mohamed, Hirani, Samtaney</a> (in turn from <a href="https://link.springer.com/book/10.1007/978-1-4612-1029-0">Marsden, Ratiu, Abraham</a>).</p><p>However, a new discretization is produced for purposes of brevity, to demonstrate novel discretizations of certain operators, and to demonstrate the automated Decapodes workflow.</p><p>The full code that generated these results is available in <a href="../ns.jl">a julia script</a>.</p><p>Let&#39;s first demonstrate an (incorrect) formulation of the equations to demonstrate how one can iteratively develop a Decapodes model. This is intended to show how easy it is to edit a Decapodes model to improve the quality of the physical formulation.</p><p>This approach can be combined with the multiphysics described in other pages to improve the quality of other fluid mechanics simulations.</p><p>An initial attempt at solving the vorticity formulation of the inviscid incompressible Navier-Stokes momentum equation could be:</p><h2 id="Vorticity-Formulation"><a class="docs-heading-anchor" href="#Vorticity-Formulation">Vorticity Formulation</a><a id="Vorticity-Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Vorticity-Formulation" title="Permalink"></a></h2><pre><code class="language-julia hljs">eq11_incorrect = @decapode begin
  d𝐮::DualForm2
  𝐮::DualForm1

  𝐮 == d₁⁻¹(d𝐮)

  ∂ₜ(d𝐮) ==  (-1) * ∘(♭♯, ⋆₁, d̃₁)(∧ᵈᵖ₁₀(𝐮, ⋆(d𝐮)))
end
nothing # hide</code></pre><p>This formulation comes from the fact that you are treating <code>du</code> (vorticity) as the only state variable and computing the velocity field, which you need to advect vorticity along the flow with a linear solve of the exterior derivative <code>d₁</code>. In other words, the velocity field is computed as the pseudo-inverse of the differential operation that computes curl.</p><h2 id="Initial-Conditions"><a class="docs-heading-anchor" href="#Initial-Conditions">Initial Conditions</a><a id="Initial-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Initial-Conditions" title="Permalink"></a></h2><p>We can check these dynamics on a couple of test cases on the sphere with well-known analytic solutions. In the case of dual Taylor vortices, we expect the vortices to repel one another, and in the case of a ring of (smoothed) point vortices, we should expect the vortices to rotate along the initial line of latitude. See &quot;Wave and vortex dynamics on the surface of a sphere&quot; (1993) from Polvani and Dritschel for analysis.</p><p>The following plots are shown from directly above the north pole of the sphere.</p><h3 id="Point-Vortices"><a class="docs-heading-anchor" href="#Point-Vortices">Point Vortices</a><a id="Point-Vortices-1"></a><a class="docs-heading-anchor-permalink" href="#Point-Vortices" title="Permalink"></a></h3><p><img src="../point_ics.png" alt="Plot of point Vortex initial conditions"/></p><h3 id="Taylor-Vortices"><a class="docs-heading-anchor" href="#Taylor-Vortices">Taylor Vortices</a><a id="Taylor-Vortices-1"></a><a class="docs-heading-anchor-permalink" href="#Taylor-Vortices" title="Permalink"></a></h3><p><img src="../taylor_ics.png" alt="Plot of Taylor Vortex initial conditions"/></p><h3 id="Numerical-Solutions-(Incorrect-formulation)"><a class="docs-heading-anchor" href="#Numerical-Solutions-(Incorrect-formulation)">Numerical Solutions (Incorrect formulation)</a><a id="Numerical-Solutions-(Incorrect-formulation)-1"></a><a class="docs-heading-anchor-permalink" href="#Numerical-Solutions-(Incorrect-formulation)" title="Permalink"></a></h3><p>This formulation is very unstable for both sets of initial conditions, failing approximately 0.4% of the way into the simulation.</p><pre><code class="language-verbatim hljs">max u=NaN
│   progress = 0.004
└ @ OrdinaryDiffEqCore /blue/fairbanksj/luke.morris/julia/packages/OrdinaryDiffEqCore/H25Bn/src/integrators/integrator_utils.jl:283
┌ Warning: Instability detected. Aborting</code></pre><pre><code class="language-verbatim hljs">max u=NaN
│   progress = 0.005
└ @ OrdinaryDiffEqCore /blue/fairbanksj/luke.morris/julia/packages/OrdinaryDiffEqCore/H25Bn/src/integrators/integrator_utils.jl:283
┌ Warning: Instability detected. Aborting</code></pre><h2 id="Streamfunction-Poisson-Formulation"><a class="docs-heading-anchor" href="#Streamfunction-Poisson-Formulation">Streamfunction-Poisson Formulation</a><a id="Streamfunction-Poisson-Formulation-1"></a><a class="docs-heading-anchor-permalink" href="#Streamfunction-Poisson-Formulation" title="Permalink"></a></h2><p>There are cohomological reasons why the above model formulation produces low-quality simulations. The variable <strong>X</strong> is physically required to be in the kernel of <span>$\Delta$</span>, but that isn&#39;t guaranteed by the model formulation above. To fix this, you can use the solve for the stream-function by introducing a Laplacian solve as part of the update law.</p><p>Due to the equation <span>$du = -\Delta\psi$</span> we can solve for the stream function with a linear solve of the Laplacian.</p><p>This transformation can be implemented by editing the Decapode formulation and regenerating the simulator.</p><pre><code class="language-julia hljs">eq11_inviscid_poisson = @decapode begin
  d𝐮::DualForm2
  𝐮::DualForm1
  ψ::Form0

  ψ == Δ⁻¹(⋆(d𝐮))
  𝐮 == ⋆(d(ψ))

  ∂ₜ(d𝐮) ==  (-1) * ∘(♭♯, ⋆₁, d̃₁)(∧ᵈᵖ₁₀(𝐮, ⋆(d𝐮)))
end</code></pre><p>With this formulation, we achieve these numerical results:</p><p><img src="../vort.gif" alt="Rotating point vortices"/></p><p><img src="../taylor_vort.gif" alt="Repelling Taylor vortices"/></p><h2 id="Phenominological-Assessment"><a class="docs-heading-anchor" href="#Phenominological-Assessment">Phenominological Assessment</a><a id="Phenominological-Assessment-1"></a><a class="docs-heading-anchor-permalink" href="#Phenominological-Assessment" title="Permalink"></a></h2><p>These scenarios are used to test that a simulator achieves the correct phenomenology. In the rotating point vortices case, we are looking for periodicity in the solution for vorticity. As the vortices advect around the sphere, they return to their original locations. This can be seen on the azimuthal profile. The original formulation does not exhibit this phenomenon, since it is unstable, but the corrected formulation does.</p><p>We can visualize the distribution of vorticity at the <span>$\theta = 0.4$</span> latitude. The difference between the distributions at <span>$t=0$</span> and <span>$t=12$</span> is accumulated error.</p><p><img src="../azimuth.png" alt="Azimuthal profile"/></p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Page built in 0 seconds.
[ Info: This page was last built at 2024-12-09T20:20:32.102.</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../equations/equations/">« Equations</a><a class="docs-footer-nextpage" href="../../harmonics/harmonics/">Harmonics »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 9 December 2024 20:22">Monday 9 December 2024</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

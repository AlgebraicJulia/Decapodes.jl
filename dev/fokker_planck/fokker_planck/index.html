<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Fokker-Planck · Decapodes.jl</title><meta name="title" content="Fokker-Planck · Decapodes.jl"/><meta property="og:title" content="Fokker-Planck · Decapodes.jl"/><meta property="twitter:title" content="Fokker-Planck · Decapodes.jl"/><meta name="description" content="Documentation for Decapodes.jl."/><meta property="og:description" content="Documentation for Decapodes.jl."/><meta property="twitter:description" content="Documentation for Decapodes.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="../../assets/analytics.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Decapodes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Decapodes.jl</a></li><li><a class="tocitem" href="../../overview/overview/">Overview</a></li><li><a class="tocitem" href="../../ice_dynamics/ice_dynamics/">Glacial Flow</a></li><li><span class="tocitem">Concepts</span><ul><li><a class="tocitem" href="../../concepts/equations/">Equations</a></li><li><a class="tocitem" href="../../concepts/composition/">Composition</a></li><li><a class="tocitem" href="../../concepts/meshes/">Meshes</a></li><li><a class="tocitem" href="../../concepts/generate/">Custom Operators</a></li></ul></li><li><span class="tocitem">Zoo</span><ul><li><a class="tocitem" href="../../navier_stokes/ns/">Vortices</a></li><li><a class="tocitem" href="../../harmonics/harmonics/">Harmonics</a></li><li><a class="tocitem" href="../../ch/cahn-hilliard/">Cahn-Hilliard</a></li><li><a class="tocitem" href="../../brussel/brussel/">Brusselator</a></li><li><a class="tocitem" href="../../klausmeier/klausmeier/">Klausmeier</a></li><li><a class="tocitem" href="../../pconv/porous_convection/">Porous Convection</a></li><li><a class="tocitem" href="../../cism/cism/">CISM v2.1</a></li><li><a class="tocitem" href="../../grigoriev/grigoriev/">Grigoriev Ice Cap</a></li><li><a class="tocitem" href="../../bsh/budyko_sellers_halfar/">Budyko-Sellers-Halfar</a></li><li><a class="tocitem" href="../../ebm_melt/ebm_melt/">Halfar-EBM-Water</a></li><li><a class="tocitem" href="../../halmo/halmo/">Halfar-NS</a></li><li><a class="tocitem" href="../../nhs/nhs_lite/">NHS</a></li><li><a class="tocitem" href="../../poiseuille/poiseuille/">Pipe Flow</a></li><li class="is-active"><a class="tocitem" href>Fokker-Planck</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li><a class="tocitem" href="../../examples/chemistry/gray_scott/">Gray-Scott</a></li><li><a class="tocitem" href="../../examples/oncology/tumor_proliferation_invasion/">Oncology</a></li><li><a class="tocitem" href="../../examples/mhd/">MHD</a></li></ul></li><li><a class="tocitem" href="../../calibrate/calibration/">Calibration</a></li><li><a class="tocitem" href="../../bc/bc_debug/">Misc Features</a></li><li><a class="tocitem" href="../../faq/faq/">FAQ</a></li><li><a class="tocitem" href="../../ascii/">ASCII Operators</a></li><li><a class="tocitem" href="../../canon/">Canonical Models</a></li><li><a class="tocitem" href="../../api/">Library Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Zoo</a></li><li class="is-active"><a href>Fokker-Planck</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Fokker-Planck</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/Decapodes.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/Decapodes.jl/blob/main/docs/src/fokker_planck/fokker_planck.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Fokker-Planck"><a class="docs-heading-anchor" href="#Fokker-Planck">Fokker-Planck</a><a id="Fokker-Planck-1"></a><a class="docs-heading-anchor-permalink" href="#Fokker-Planck" title="Permalink"></a></h1><pre><code class="language-julia hljs">using Catlab, CombinatorialSpaces, Decapodes, DiagrammaticEquations
using CairoMakie, ComponentArrays, LinearAlgebra, MLStyle, ComponentArrays
using OrdinaryDiffEq
using GeometryBasics: Point3
Point3D = Point3{Float64}
using Arpack</code></pre><p>Let&#39;s specify physics</p><pre><code class="language-julia hljs">Fokker_Planck = @decapode begin
  (ρ,Ψ)::Form0
  β⁻¹::Constant
  ∂ₜ(ρ) == ∘(⋆,d,⋆)(d(Ψ)∧ρ) + β⁻¹*Δ(ρ)
end</code></pre><div class="c-set">
<span class="c-set-summary">DiagrammaticEquations.decapodeacset.SummationDecapode{Any, Any, Symbol} {Var:9, TVar:1, Op1:4, Op2:2, Σ:1, Summand:2, Type:0, Operator:0, Name:0}</span>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Var</th>
      <th style = "text-align: right;">type</th>
      <th style = "text-align: right;">name</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">Form0</td>
      <td style = "text-align: right;">ρ</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">Form0</td>
      <td style = "text-align: right;">Ψ</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">Constant</td>
      <td style = "text-align: right;">β⁻¹</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">infer</td>
      <td style = "text-align: right;">ρ̇</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td>
      <td style = "text-align: right;">infer</td>
      <td style = "text-align: right;">•2</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td>
      <td style = "text-align: right;">infer</td>
      <td style = "text-align: right;">•3</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td>
      <td style = "text-align: right;">infer</td>
      <td style = "text-align: right;">•4</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td>
      <td style = "text-align: right;">infer</td>
      <td style = "text-align: right;">•5</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td>
      <td style = "text-align: right;">infer</td>
      <td style = "text-align: right;">•6</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">TVar</th>
      <th style = "text-align: right;">incl</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">4</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Op1</th>
      <th style = "text-align: right;">src</th>
      <th style = "text-align: right;">tgt</th>
      <th style = "text-align: right;">op1</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">4</td>
      <td style = "text-align: right;">∂ₜ</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">2</td>
      <td style = "text-align: right;">7</td>
      <td style = "text-align: right;">d</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td>
      <td style = "text-align: right;">6</td>
      <td style = "text-align: right;">5</td>
      <td style = "text-align: right;">[:⋆, :d, :⋆]</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">9</td>
      <td style = "text-align: right;">Δ</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Op2</th>
      <th style = "text-align: right;">proj1</th>
      <th style = "text-align: right;">proj2</th>
      <th style = "text-align: right;">res</th>
      <th style = "text-align: right;">op2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">7</td>
      <td style = "text-align: right;">1</td>
      <td style = "text-align: right;">6</td>
      <td style = "text-align: right;">∧</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">3</td>
      <td style = "text-align: right;">9</td>
      <td style = "text-align: right;">8</td>
      <td style = "text-align: right;">*</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Σ</th>
      <th style = "text-align: right;">sum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">4</td>
    </tr>
  </tbody>
</table>
<table>
  <thead>
    <tr class = "header headerLastRow">
      <th class = "rowLabel" style = "font-weight: bold; text-align: right;">Summand</th>
      <th style = "text-align: right;">summand</th>
      <th style = "text-align: right;">summation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td>
      <td style = "text-align: right;">5</td>
      <td style = "text-align: right;">1</td>
    </tr>
    <tr>
      <td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td>
      <td style = "text-align: right;">8</td>
      <td style = "text-align: right;">1</td>
    </tr>
  </tbody>
</table>
</div>
<p>Specify the domain</p><pre><code class="language-julia hljs">spheremesh = loadmesh(Icosphere(6))
dualmesh = EmbeddedDeltaDualComplex2D{Bool, Float64, Point3D}(spheremesh);
subdivide_duals!(dualmesh, Barycenter())</code></pre><p>Compile the simulation</p><pre><code class="language-julia hljs">simulation = eval(gensim(Fokker_Planck))
f = simulation(dualmesh, nothing)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">f (generic function with 1 method)</code></pre><p>Specify initial conditions. Ψ must be a smooth function. Choose an interesting eigenfunction. We require that ρ integrated over the surface is 1, since it is a PDF. On a sphere where ρ(x,y,z) is proportional to the x-coordinate, that means divide by 2π.</p><pre><code class="language-julia hljs">Δ0 = Δ(0, dualmesh)
Ψ = real.(eigs(Δ0, nev=32, which=:LR)[2][:,32])
ρ = map(point(dualmesh)) do (x,y,z)
  abs(x)
end / 2π</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">10242-element Vector{Float64}:
 0.0
 0.11516563149298982
 0.043988514743502356
 0.14235231725145778
 0.043988514743502356
 0.11516563149298982
 0.043988514743502356
 0.11516563149298982
 0.11516563149298982
 0.043988514743502356
 ⋮
 0.08967283264868502
 0.09289301071025216
 0.09592698073957182
 0.09877362334453003
 0.10143374486690382
 0.10391019121884734
 0.1062071174321057
 0.10833040505846418
 0.11028673250511124</code></pre><p>Let&#39;s define the structures which hold the constants and state variables for the simulation, respectively.</p><pre><code class="language-julia hljs">constants_and_parameters = (β⁻¹ = 1e-2,)
u0 = ComponentArray(Ψ=Ψ, ρ=ρ)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.0, 0.11516563149298982, 0.043988514743502356, 0.14235231725145778, 0.043988514743502356, 0.11516563149298982, 0.043988514743502356, 0.11516563149298982, 0.11516563149298982, 0.043988514743502356  …  0.08627041185913856, 0.08967283264868502, 0.09289301071025216, 0.09592698073957182, 0.09877362334453003, 0.10143374486690382, 0.10391019121884734, 0.1062071174321057, 0.10833040505846418, 0.11028673250511124])</code></pre><p>Run the simulation.</p><pre><code class="language-julia hljs">tₑ= 20.0
problem = ODEProblem(f, u0, (0, tₑ), constants_and_parameters);
solution = solve(problem, Tsit5(), progress=true, progress_steps=1);</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">retcode: Success
Interpolation: specialized 4th order &quot;free&quot; interpolation
t: 434-element Vector{Float64}:
  0.0
  0.040156034184407725
  0.06178401641181578
  0.10596477933783918
  0.14712219589111403
  0.20967779018574592
  0.2815541615897323
  0.3516415764146215
  0.4101154389279427
  0.4587824866755638
  ⋮
 19.658023174702542
 19.704214154826786
 19.75040513002233
 19.796596100289168
 19.842787069147807
 19.888978033429794
 19.93516899665563
 19.981359959177365
 20.0
u: 434-element Vector{ComponentArrays.ComponentVector{Float64, Vector{Float64}, Tuple{ComponentArrays.Axis{(Ψ = ViewAxis(1:10242, Shaped1DAxis((10242,))), ρ = ViewAxis(10243:20484, Shaped1DAxis((10242,))))}}}}:
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.0, 0.11516563149298982, 0.043988514743502356, 0.14235231725145778, 0.043988514743502356, 0.11516563149298982, 0.043988514743502356, 0.11516563149298982, 0.11516563149298982, 0.043988514743502356  …  0.08627041185913856, 0.08967283264868502, 0.09289301071025216, 0.09592698073957182, 0.09877362334453003, 0.10143374486690382, 0.10391019121884734, 0.1062071174321057, 0.10833040505846418, 0.11028673250511124])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.0029915506805808785, 0.1181835177597337, 0.04365110362337344, 0.1392743833900675, 0.04326420346950505, 0.11772137531666127, 0.04464600388438386, 0.11248229943095026, 0.1120133871077407, 0.044225724334400036  …  0.08657986270364423, 0.09028309817457064, 0.09382886783151406, 0.09720076834733261, 0.10038501644803667, 0.10337030066383016, 0.10614888355226738, 0.10871596349351499, 0.11107074076156344, 0.11321555675561254])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.003998543215753561, 0.11981554923936125, 0.04347526313066022, 0.13774810269419324, 0.04288380861160618, 0.11910003977517762, 0.04498443643962244, 0.11107581936709993, 0.11036535728630517, 0.04433947589503494  …  0.08673717499783277, 0.09060056650947527, 0.09432108196567814, 0.09787573058959312, 0.10124384059569677, 0.10440737246098991, 0.10735248226334322, 0.11006915164246177, 0.1125525410785688, 0.1148023285014377])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.005580205292779603, 0.1231620425236253, 0.0431291840189902, 0.13479175861129264, 0.04212836428356792, 0.12191971556834968, 0.04564204743409593, 0.108284389236565, 0.10710331210945165, 0.04454212895086865  …  0.08703899217916351, 0.0912253827801032, 0.0953011970911259, 0.0992303330909839, 0.10297798731368918, 0.10651194762028567, 0.10980512680051027, 0.11283596028498641, 0.11559038472439229, 0.1180613185848593])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.006832191801964912, 0.12629447961307344, 0.04281198912407427, 0.1321597758996952, 0.04143971183781915, 0.12455038750394547, 0.04622398357036151, 0.10577289146992312, 0.10417936832968369, 0.04470531178451453  …  0.08729739778815623, 0.09177955364013946, 0.09618403143048807, 0.10046300021947988, 0.10456849775768594, 0.10845464978178755, 0.11208117807166887, 0.11541468470389607, 0.11843129054175905, 0.12111649397153827])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.008531475693080345, 0.13107721799914823, 0.042341443215549626, 0.12833685405989906, 0.04042283657627257, 0.12855178496289346, 0.047051993983174965, 0.10211231434454754, 0.0999367056244345, 0.04490748612468438  …  0.08765008444008299, 0.0925721072000038, 0.0974711669218607, 0.10228261624275721, 0.10693867053046013, 0.11137200856016469, 0.11552087433551232, 0.11933194138892794, 0.12276428617679923, 0.1257900575641588])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.01030097715789275, 0.13659048651846517, 0.041848466966041435, 0.12418104803846747, 0.03933057075429624, 0.13314319389698373, 0.04789734058549928, 0.09814422354753459, 0.09536229604572408, 0.04505119562782132  …  0.08799893186936922, 0.0934117553978454, 0.09887072644696962, 0.10429351700370869, 0.10959007619736526, 0.11466770107997014, 0.11943807974956754, 0.12382219746936292, 0.12775698580354541, 0.13119431554976574])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.011794211800009106, 0.1419061686812695, 0.04184923860545395, 0.1204350211818188, 0.03880474419803665, 0.13755241580504216, 0.048248221168149724, 0.09478777478181344, 0.09148978028788993, 0.0447296561445119  …  0.08828475459616363, 0.09416102346643593, 0.10015640333054728, 0.10617311982922757, 0.1121001688043375, 0.1178196329641109, 0.12321575183835191, 0.1281807798058015, 0.13263411564995106, 0.1364753356807245])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.012903886797711449, 0.14612514225500461, 0.04329655090938508, 0.11756669370836305, 0.03994512970812584, 0.1410442182524369, 0.04727084153335135, 0.09311600631325477, 0.08948982634608738, 0.043159191714348115  …  0.08848476272160577, 0.09473626609561535, 0.10117138686397965, 0.1076808601743692, 0.1141369041957882, 0.12040040805573289, 0.12633196501320465, 0.13179473032138717, 0.13671248006153178, 0.14085036737361134])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.014118711819835613, 0.14974997333200946, 0.04381720690257973, 0.11503947468732992, 0.04019101838006354, 0.14402961705357228, 0.0470317593513623, 0.09140277975620748, 0.08751079211720408, 0.04242770136580273  …  0.08862606814533172, 0.09518201234488918, 0.10197745874797991, 0.10889455387455614, 0.11579211066868426, 0.1225133669658442, 0.12889845641946576, 0.1347870008146042, 0.14009360124707265, 0.1445178236923178])
 ⋮
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.1694274823653684, 0.39914712710337213, 0.06314333780827522, 0.01403850475006412, 0.03075290399013696, 0.3301841927029838, 0.05552197579696151, 0.010710207147189421, 0.007460122558549848, 0.030821031886332614  …  0.07524681914469261, 0.0975382629989876, 0.12611216128749175, 0.16134230664315943, 0.20283139616117982, 0.24916452835177197, 0.2978477200787326, 0.345528501125847, 0.3884685939362251, 0.4231909903561857])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.1695126433677729, 0.3991628055096701, 0.06315683754714015, 0.014028095776824743, 0.030759944608988104, 0.33016026827862954, 0.05555264430937542, 0.010707473307876275, 0.007457928288960063, 0.030838357884082165  …  0.07525810628209081, 0.09755190289584083, 0.12612861932599032, 0.16136193115994324, 0.20285431207383786, 0.24919053507849676, 0.29787622495553645, 0.3455585217787165, 0.3884988394103614, 0.4232200145295503])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.1695975876960737, 0.3991784702290464, 0.06317022707366084, 0.014017748029331867, 0.030766934434042083, 0.3301363659201128, 0.05558330689986908, 0.010704749970092055, 0.007455736135262734, 0.030855685871154198  …  0.07526936842641167, 0.09756550633530633, 0.12614502702651942, 0.16138148967293295, 0.2028771458022889, 0.24921644481013286, 0.2979046216734655, 0.3455884289982345, 0.3885289737869958, 0.42324893831173943])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.16968231684503635, 0.39919412178798025, 0.06318350724533664, 0.014007460989045328, 0.030773873843589015, 0.3301124861716497, 0.055613963333125266, 0.01070203703080808, 0.0074535460732272855, 0.030873015543604086  …  0.07528060555336312, 0.09757907341085309, 0.12616138463510454, 0.16140098261324198, 0.2028998979858883, 0.24924225840018224, 0.29793291128228294, 0.3456182239860899, 0.3885589983515227, 0.42327776298776626])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.16976683229744757, 0.39920976070087766, 0.0631966789135027, 0.01399723414207791, 0.03078076321347246, 0.3300886295632125, 0.05564461337856919, 0.010699334410978225, 0.0074513581904663145, 0.030890346602061764  …  0.07529181764192149, 0.09759260421792491, 0.12617769239793258, 0.1614204104097853, 0.2029225692589366, 0.24926797669389947, 0.2979610948202373, 0.3456479079294589, 0.38858891437242793, 0.4233064898242382])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.16985113550568334, 0.3992253874668686, 0.06320974292047561, 0.013987066981392283, 0.030787602915567494, 0.3300647966160266, 0.05567525680356962, 0.01069664199113798, 0.007449172364235465, 0.03090767874787833  …  0.07530300467180197, 0.09760609885091555, 0.12619395055774407, 0.16143977348501695, 0.20294516024574596, 0.2492936005227386, 0.2979891733080259, 0.3456774819946812, 0.3886187230949708, 0.4233351200633321])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.16993522791644103, 0.39924100257459666, 0.06322270010343352, 0.013976959003773666, 0.030794393319824788, 0.33004098783588576, 0.055705893382292225, 0.01069395969563882, 0.007446988683563047, 0.030925011688097196  …  0.07531416662665624, 0.09761955740705827, 0.12621015935855237, 0.16145907226059325, 0.2029676715672894, 0.2493191307119354, 0.2980171477571442, 0.3457069473361116, 0.3886484257501373, 0.42336365493144357])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.1700191109529591, 0.3992566064991254, 0.06323555129166843, 0.013966909711946493, 0.030801134792805072, 0.3300172037184629, 0.05573652288913495, 0.010691287430547683, 0.007444807138179119, 0.030942345131733374  …  0.07532530349163138, 0.09763297998350932, 0.12622631904216358, 0.16147830715326153, 0.20299010383644361, 0.24934456807515692, 0.29804501916406606, 0.3457363050900252, 0.38867802354855113, 0.42339209563338076])
 ComponentVector{Float64}(Ψ = [-0.014767176072532754, -0.021254817916076724, -0.0021993965329928688, 0.015417913777228136, 0.004964976549972716, -0.018073479527875948, -0.0052409796996306405, 0.01790034431924897, 0.021317872220949427, 0.0024402094960582397  …  -0.005018729122620707, -0.00754481379967414, -0.010054521179839286, -0.01246644793296419, -0.014710154266262954, -0.016728599079709635, -0.018479063759267608, -0.01993335460831603, -0.021076591574020958, -0.021906101823276448], ρ = [0.17005290239343643, 0.3992629002924938, 0.06324070697074519, 0.013962870897976022, 0.030803831987697327, 0.3300076128982887, 0.05574888119215861, 0.010655690482785498, 0.007269659110466821, 0.030949345140698435  …  0.07532979058759127, 0.09763838640360596, 0.12623282631474916, 0.16148605126266888, 0.20299913397285804, 0.24935480704065902, 0.29805623751860627, 0.34574812199347965, 0.3886899381100674, 0.4234035462826334])</code></pre><p>Verify that the probability distribbution function is still a probability distribution. We&#39;ll show that the sum of the values on the dual 2-form integrate (sum to) unity,</p><pre><code class="language-julia hljs">s0 = dec_hodge_star(0, dualmesh)
@info sum(s0 * solution(tₑ).ρ)
@info any(solution(tₑ).ρ .≤ 0)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: 0.9996960076315164
[ Info: false</code></pre><p>Now we will create a GIF.</p><pre><code class="language-julia hljs">function save_gif(file_name, soln)
  time = Observable(0.0)
  fig = Figure()
  Label(fig[1, 1, Top()], @lift(&quot;ρ at $($time)&quot;), padding = (0, 0, 5, 0))
  ax = LScene(fig[1,1], scenekw=(lights=[],))
  msh = CairoMakie.mesh!(ax, spheremesh,
    color=@lift(soln($time).ρ),
    colorrange=(0,1),
    colormap=:jet)

  Colorbar(fig[1,2], msh)
  frames = range(0.0, tₑ; length=21)
  record(fig, file_name, frames; framerate = 10) do t
    time[] = t
  end
end
gif = save_gif(&quot;fokker_planck.gif&quot;, solution)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;fokker_planck.gif&quot;</code></pre><p><img src="../fokker_planck.gif" alt="&quot;FokkerPlanck&quot;"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../poiseuille/poiseuille/">« Pipe Flow</a><a class="docs-footer-nextpage" href="../../examples/chemistry/gray_scott/">Gray-Scott »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.1 on <span class="colophon-date" title="Saturday 15 March 2025 01:44">Saturday 15 March 2025</span>. Using Julia version 1.11.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

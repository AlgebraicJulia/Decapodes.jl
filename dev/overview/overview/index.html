<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Overview · Decapodes.jl</title><meta name="title" content="Overview · Decapodes.jl"/><meta property="og:title" content="Overview · Decapodes.jl"/><meta property="twitter:title" content="Overview · Decapodes.jl"/><meta name="description" content="Documentation for Decapodes.jl."/><meta property="og:description" content="Documentation for Decapodes.jl."/><meta property="twitter:description" content="Documentation for Decapodes.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><script src="../../assets/analytics.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Decapodes.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Decapodes.jl</a></li><li class="is-active"><a class="tocitem" href>Overview</a><ul class="internal"><li><a class="tocitem" href="#Your-First-Decapode"><span>Your First Decapode</span></a></li><li><a class="tocitem" href="#A-Little-More-Complicated"><span>A Little More Complicated</span></a></li><li><a class="tocitem" href="#Bring-in-the-Dynamics"><span>Bring in the Dynamics</span></a></li><li><a class="tocitem" href="#Merging-Multiple-Physics"><span>Merging Multiple Physics</span></a></li></ul></li><li><a class="tocitem" href="../../equations/equations/">Equations</a></li><li><a class="tocitem" href="../../navier_stokes/ns/">Vortices</a></li><li><a class="tocitem" href="../../ch/cahn-hilliard/">Cahn-Hilliard</a></li><li><a class="tocitem" href="../../klausmeier/klausmeier/">Klausmeier</a></li><li><a class="tocitem" href="../../cism/cism/">CISM v2.1</a></li><li><a class="tocitem" href="../../ice_dynamics/ice_dynamics/">Glacial Flow</a></li><li><a class="tocitem" href="../../grigoriev/grigoriev/">Grigoriev Ice Cap</a></li><li><a class="tocitem" href="../../bsh/budyko_sellers_halfar/">Budyko-Sellers-Halfar</a></li><li><a class="tocitem" href="../../halmo/halmo/">Halfar-NS</a></li><li><a class="tocitem" href="../../nhs/nhs_lite/">NHS</a></li><li><a class="tocitem" href="../../poiseuille/poiseuille/">Pipe Flow</a></li><li><a class="tocitem" href="../../bc/bc_debug/">Misc Features</a></li><li><a class="tocitem" href="../../ascii/">ASCII Operators</a></li><li><a class="tocitem" href="../../canon/">Canonical Models</a></li><li><a class="tocitem" href="../../api/">Library Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Overview</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Overview</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/Decapodes.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/AlgebraicJulia/Decapodes.jl/blob/main/docs/src/overview/overview.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction-to-Decapodes"><a class="docs-heading-anchor" href="#Introduction-to-Decapodes">Introduction to Decapodes</a><a id="Introduction-to-Decapodes-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction-to-Decapodes" title="Permalink"></a></h1><p>Discrete Exterior Calculus Applied to Partial and Ordinary Differential Equations (Decapodes) is a diagrammatic language used to express systems of ordinary and partial differential equations. Decapodes provides a visual framework for understanding the coupling between variables within a PDE or ODE system, and a combinatorial data structure for working with them. Below, we provide a high-level overview of how Decapodes can be generated and interpreted.</p><h2 id="Your-First-Decapode"><a class="docs-heading-anchor" href="#Your-First-Decapode">Your First Decapode</a><a id="Your-First-Decapode-1"></a><a class="docs-heading-anchor-permalink" href="#Your-First-Decapode" title="Permalink"></a></h2><p>In the Decapodes graphical paradigm, nodes represent variables and arrows represent operators which relate variables to each other. Since Decapodes applies this diagrammatic language specifically to the Discrete Exterior Calculus (DEC), variables are typed by the dimension and orientation of the information they contain. So a variable of type <code>Form0</code> will be the 0-dimensional data points defined the vertices of a mesh. Similarly, <code>Form1</code> will be values stored on edges of the mesh and <code>Form2</code> will be values stored on the surfaces of the mesh.</p><p>Below, we provide a Decapode with just a single variable <code>C</code> and display it.</p><pre><code class="language-julia hljs">using Catlab
using Decapodes
using DiagrammaticEquations

Variable = @decapode begin
  C::Form0
end;

to_graphviz(Variable)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="55pt" height="69pt"
 viewBox="0.00 0.00 54.63 69.21" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 65.21)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-65.21 50.63,-65.21 50.63,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="black" cx="22.63" cy="-10.61" rx="22.76" ry="10.71"/>
<text text-anchor="middle" x="22.63" y="-6.91" font-family="Times,serif" font-size="14.00">C:Ω₀</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
</g>
<!-- n2&%2345;&gt;n1 -->
<g id="edge1" class="edge">
<title>n2&%2345;&gt;n1</title>
<path fill="none" stroke="black" d="M22.63,-57.06C22.63,-52.88 22.63,-38.14 22.63,-26.57"/>
<polygon fill="black" stroke="black" points="24.38,-26.52 22.63,-21.52 20.88,-26.52 24.38,-26.52"/>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
</g>
</g>
</svg>
'/><p>The resulting diagram contains a single node, showing the single variable in this system. We can add a second variable:</p><pre><code class="language-julia hljs">TwoVariables = @decapode begin
  C::Form0
  dC::Form1
end;

to_graphviz(TwoVariables)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="130pt" height="69pt"
 viewBox="0.00 0.00 129.62 69.21" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 65.21)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-65.21 125.62,-65.21 125.62,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="black" cx="22.63" cy="-10.61" rx="22.76" ry="10.71"/>
<text text-anchor="middle" x="22.63" y="-6.91" font-family="Times,serif" font-size="14.00">C:Ω₀</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="black" cx="92.63" cy="-10.61" rx="28.98" ry="10.71"/>
<text text-anchor="middle" x="92.63" y="-6.91" font-family="Times,serif" font-size="14.00">dC:Ω₁</text>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
</g>
<!-- n3&%2345;&gt;n1 -->
<g id="edge1" class="edge">
<title>n3&%2345;&gt;n1</title>
<path fill="none" stroke="black" d="M56.76,-57.06C53.5,-52.72 41.68,-36.98 32.86,-25.23"/>
<polygon fill="black" stroke="black" points="34.16,-24.06 29.76,-21.11 31.37,-26.16 34.16,-24.06"/>
</g>
<!-- n3&%2345;&gt;n2 -->
<g id="edge2" class="edge">
<title>n3&%2345;&gt;n2</title>
<path fill="none" stroke="black" d="M58.49,-57.06C61.76,-52.72 73.58,-36.98 82.4,-25.23"/>
<polygon fill="black" stroke="black" points="83.89,-26.16 85.49,-21.11 81.09,-24.06 83.89,-26.16"/>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
</g>
</g>
</svg>
'/><p>We can also add a relationship between them. In this case, we make an equation which states that <code>dC</code> is the derivative of <code>C</code>:</p><pre><code class="language-julia hljs">Equation = @decapode begin
  C::Form0
  dC::Form1

  dC == d(C)
end;

to_graphviz(Equation)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="66pt" height="142pt"
 viewBox="0.00 0.00 65.98 142.43" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 138.43)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-138.43 61.98,-138.43 61.98,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="black" cx="28.99" cy="-82.82" rx="22.76" ry="10.71"/>
<text text-anchor="middle" x="28.99" y="-79.12" font-family="Times,serif" font-size="14.00">C:Ω₀</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="black" cx="28.99" cy="-10.61" rx="28.98" ry="10.71"/>
<text text-anchor="middle" x="28.99" y="-6.91" font-family="Times,serif" font-size="14.00">dC:Ω₁</text>
</g>
<!-- n1&%2345;&gt;n2 -->
<g id="edge2" class="edge">
<title>n1&%2345;&gt;n2</title>
<path fill="none" stroke="black" d="M28.99,-72.06C28.99,-60.21 28.99,-40.13 28.99,-26.39"/>
<polygon fill="black" stroke="black" points="30.74,-26.29 28.99,-21.29 27.24,-26.29 30.74,-26.29"/>
<text text-anchor="middle" x="33.99" y="-43.01" font-family="Times,serif" font-size="14.00">d</text>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
</g>
<!-- n3&%2345;&gt;n1 -->
<g id="edge1" class="edge">
<title>n3&%2345;&gt;n1</title>
<path fill="none" stroke="black" d="M28.99,-130.25C28.99,-125.93 28.99,-110.57 28.99,-98.69"/>
<polygon fill="black" stroke="black" points="30.74,-98.53 28.99,-93.53 27.24,-98.53 30.74,-98.53"/>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
</g>
</g>
</svg>
'/><p>Here, the two nodes represent the two variables, and the arrow between them shows how they are related by the derivative.</p><h2 id="A-Little-More-Complicated"><a class="docs-heading-anchor" href="#A-Little-More-Complicated">A Little More Complicated</a><a id="A-Little-More-Complicated-1"></a><a class="docs-heading-anchor-permalink" href="#A-Little-More-Complicated" title="Permalink"></a></h2><p>Now that we&#39;ve seen how to construct a simple equation, it&#39;s time to move on to some actual PDE systems! One classic PDE example is the diffusion equation. This equation states that the change of concentration at each point is proportional to the Laplacian of the concentration.</p><pre><code class="language-julia hljs">Diffusion = @decapode begin
  (C, Ċ)::Form0
  ϕ::Form1

  # Fick&#39;s first law
  ϕ ==  k(d₀(C))

  # Diffusion equation
  Ċ == ⋆₀⁻¹(dual_d₁(⋆₁(ϕ)))
  ∂ₜ(C) == Ċ

end;

to_graphviz(Diffusion)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="125pt" height="472pt"
 viewBox="0.00 0.00 124.63 472.28" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 468.28)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-468.28 120.63,-468.28 120.63,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="black" cx="22.63" cy="-412.67" rx="22.76" ry="10.71"/>
<text text-anchor="middle" x="22.63" y="-408.97" font-family="Times,serif" font-size="14.00">C:Ω₀</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="black" cx="22.63" cy="-51.61" rx="22.76" ry="10.71"/>
<text text-anchor="middle" x="22.63" y="-47.91" font-family="Times,serif" font-size="14.00">Ċ:Ω₀</text>
</g>
<!-- n1&%2345;&gt;n2 -->
<g id="edge8" class="edge">
<title>n1&%2345;&gt;n2</title>
<path fill="none" stroke="black" d="M18.92,-401.83C14.19,-388.4 6.63,-363.46 6.63,-341.46 6.63,-341.46 6.63,-341.46 6.63,-122.82 6.63,-103.22 12.63,-81.3 17.28,-67.25"/>
<polygon fill="black" stroke="black" points="18.96,-67.74 18.92,-62.44 15.65,-66.61 18.96,-67.74"/>
<text text-anchor="middle" x="12.63" y="-228.44" font-family="Times,serif" font-size="14.00">∂ₜ</text>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
<ellipse fill="none" stroke="black" cx="64.63" cy="-340.46" rx="29.9" ry="10.71"/>
<text text-anchor="middle" x="64.63" y="-336.76" font-family="Times,serif" font-size="14.00">•2:Ω•</text>
</g>
<!-- n1&%2345;&gt;n5 -->
<g id="edge3" class="edge">
<title>n1&%2345;&gt;n5</title>
<path fill="none" stroke="black" d="M28.29,-402.2C35.45,-390.23 47.85,-369.51 56.14,-355.65"/>
<polygon fill="black" stroke="black" points="57.72,-356.42 58.78,-351.23 54.71,-354.62 57.72,-356.42"/>
<text text-anchor="middle" x="55.13" y="-372.87" font-family="Times,serif" font-size="14.00">d₀</text>
</g>
<!-- n8 -->
<g id="node8" class="node">
<title>n8</title>
</g>
<!-- n2&%2345;&gt;n8 -->
<g id="edge2" class="edge">
<title>n2&%2345;&gt;n8</title>
<path fill="none" stroke="black" d="M22.63,-40.97C22.63,-31.46 22.63,-17.21 22.63,-9.14"/>
<polygon fill="black" stroke="black" points="24.38,-9.06 22.63,-4.06 20.88,-9.06 24.38,-9.06"/>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="none" stroke="black" cx="64.63" cy="-268.25" rx="21.84" ry="10.71"/>
<text text-anchor="middle" x="64.63" y="-264.55" font-family="Times,serif" font-size="14.00">ϕ:Ω₁</text>
</g>
<!-- n6 -->
<g id="node6" class="node">
<title>n6</title>
<ellipse fill="none" stroke="black" cx="64.63" cy="-196.03" rx="29.9" ry="10.71"/>
<text text-anchor="middle" x="64.63" y="-192.33" font-family="Times,serif" font-size="14.00">•3:Ω•</text>
</g>
<!-- n3&%2345;&gt;n6 -->
<g id="edge5" class="edge">
<title>n3&%2345;&gt;n6</title>
<path fill="none" stroke="black" d="M64.63,-257.48C64.63,-245.64 64.63,-225.56 64.63,-211.82"/>
<polygon fill="black" stroke="black" points="66.38,-211.71 64.63,-206.71 62.88,-211.71 66.38,-211.71"/>
<text text-anchor="middle" x="72.13" y="-228.44" font-family="Times,serif" font-size="14.00">⋆₁</text>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
<ellipse fill="none" stroke="black" cx="64.63" cy="-123.82" rx="29.9" ry="10.71"/>
<text text-anchor="middle" x="64.63" y="-120.12" font-family="Times,serif" font-size="14.00">•1:Ω•</text>
</g>
<!-- n4&%2345;&gt;n2 -->
<g id="edge7" class="edge">
<title>n4&%2345;&gt;n2</title>
<path fill="none" stroke="black" d="M58.96,-113.35C51.72,-101.24 39.13,-80.19 30.84,-66.33"/>
<polygon fill="black" stroke="black" points="32.27,-65.32 28.2,-61.93 29.27,-67.12 32.27,-65.32"/>
<text text-anchor="middle" x="61.63" y="-84.01" font-family="Times,serif" font-size="14.00">⋆₀⁻¹</text>
</g>
<!-- n5&%2345;&gt;n3 -->
<g id="edge4" class="edge">
<title>n5&%2345;&gt;n3</title>
<path fill="none" stroke="black" d="M64.63,-329.7C64.63,-317.85 64.63,-297.77 64.63,-284.03"/>
<polygon fill="black" stroke="black" points="66.38,-283.93 64.63,-278.93 62.88,-283.93 66.38,-283.93"/>
<text text-anchor="middle" x="69.13" y="-300.65" font-family="Times,serif" font-size="14.00">k</text>
</g>
<!-- n6&%2345;&gt;n4 -->
<g id="edge6" class="edge">
<title>n6&%2345;&gt;n4</title>
<path fill="none" stroke="black" d="M64.63,-185.27C64.63,-173.43 64.63,-153.35 64.63,-139.6"/>
<polygon fill="black" stroke="black" points="66.38,-139.5 64.63,-134.5 62.88,-139.5 66.38,-139.5"/>
<text text-anchor="middle" x="90.63" y="-156.23" font-family="Times,serif" font-size="14.00">dual_d₁</text>
</g>
<!-- n7 -->
<g id="node7" class="node">
<title>n7</title>
</g>
<!-- n7&%2345;&gt;n1 -->
<g id="edge1" class="edge">
<title>n7&%2345;&gt;n1</title>
<path fill="none" stroke="black" d="M22.63,-460.1C22.63,-455.78 22.63,-440.42 22.63,-428.54"/>
<polygon fill="black" stroke="black" points="24.38,-428.38 22.63,-423.38 20.88,-428.38 24.38,-428.38"/>
</g>
</g>
</svg>
'/><p>The resulting Decapode shows the relationships between the three variables with the triangle diagram. Note that these diagrams are automatically layed-out by <a href="https://graphviz.org/">Graphviz</a>.</p><h2 id="Bring-in-the-Dynamics"><a class="docs-heading-anchor" href="#Bring-in-the-Dynamics">Bring in the Dynamics</a><a id="Bring-in-the-Dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Bring-in-the-Dynamics" title="Permalink"></a></h2><p>Now that we have a reasonably complex PDE, we can demonstrate some of the developed tooling for actually solving the PDE. Currently, the tooling will automatically generate an explicit method for solving the system (using <a href="https://github.com/SciML/DifferentialEquations.jl?tab=readme-ov-file">DifferentialEquations.jl</a> to handle time-stepping and instability detection).</p><p><code>Torus_30x10</code> is a default mesh that is downloaded via <code>Artifacts.jl</code> when a user installs <a href="https://github.com/AlgebraicJulia/CombinatorialSpaces.jl">CombinatorialSpaces.jl</a>. If we wanted, we could also instantiate any <code>.obj</code> file of triangulated faces as a simplicial set although we do not here.</p><p>We will also upload a non-periodic mesh for the sake of visualization, as well as a mapping between the points on the periodic and non-periodic meshes.</p><pre><code class="language-julia hljs">using CairoMakie
using CombinatorialSpaces

plot_mesh = loadmesh(Rectangle_30x10())
periodic_mesh = loadmesh(Torus_30x10())
point_map = loadmesh(Point_Map())

fig = Figure()
ax = CairoMakie.Axis(fig[1,1], aspect = AxisAspect(3.0))
wireframe!(ax, plot_mesh)
fig</code></pre><img src="f8d72fc5.png" alt="Example block output"/><p>Now we create a function which links the names of functions used in the Decapode to their implementations. Note that many DEC operators are already defined for you.</p><p>As an example, we chose to define <code>k</code> as a function that multiplies an input by <code>0.05</code>. We could have alternately chosen to represent <code>k</code> as a <code>Constant</code> that we multiply by in the Decapode itself.</p><p>We then compile the simulation by using <code>gen_sim</code> and create functional simulation by calling the evaluated <code>sim</code>  with the mesh and our <code>generate</code> function.</p><pre><code class="language-julia hljs">using MLStyle

function generate(sd, my_symbol; hodge=DiagonalHodge())
  op = @match my_symbol begin
    :k =&gt; x -&gt; 0.05*x
    x =&gt; error(&quot;Unmatched operator $my_symbol&quot;)
  end
  return op
end

sim = eval(gensim(Diffusion))
fₘ = sim(periodic_mesh, generate, DiagonalHodge())</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">(::Main.var&quot;#f#6&quot;{PreallocationTools.FixedSizeDiffCache{Vector{Float64}, Vector{ForwardDiff.Dual{nothing, Float64, 12}}}, PreallocationTools.FixedSizeDiffCache{Vector{Float64}, Vector{ForwardDiff.Dual{nothing, Float64, 12}}}, PreallocationTools.FixedSizeDiffCache{Vector{Float64}, Vector{ForwardDiff.Dual{nothing, Float64, 12}}}, PreallocationTools.FixedSizeDiffCache{Vector{Float64}, Vector{ForwardDiff.Dual{nothing, Float64, 12}}}, Main.var&quot;#2#3&quot;, LinearAlgebra.Diagonal{Float64, Vector{Float64}}, SparseArrays.SparseMatrixCSC{Int8, Int32}, LinearAlgebra.Diagonal{Float64, Vector{Float64}}, SparseArrays.SparseMatrixCSC{Int8, Int32}}) (generic function with 1 method)</code></pre><p>We go ahead and set up our initial conditions for this problem. In this case we generate a Gaussian and apply it to our mesh.</p><pre><code class="language-julia hljs">using Distributions
c_dist = MvNormal([7, 5], [1.5, 1.5])
c = [pdf(c_dist, [p[1], p[2]]) for p in periodic_mesh[:point]]

fig = Figure()
ax = CairoMakie.Axis(fig[1,1], aspect = AxisAspect(3.0))
mesh!(ax, plot_mesh; color=c[point_map])
fig</code></pre><img src="a5376af8.png" alt="Example block output"/><p>Finally, we solve this PDE problem using the <code>Tsit5()</code> solver provided by DifferentialEquations.jl.</p><pre><code class="language-julia hljs">using LinearAlgebra
using ComponentArrays
using OrdinaryDiffEq

u₀ = ComponentArray(C=c)

prob = ODEProblem(fₘ, u₀, (0.0, 100.0))
sol = solve(prob, Tsit5());
sol.retcode</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">ReturnCode.Success = 1</code></pre><p>Now that the simulation has succeeded we can plot out our results with <a href="https://github.com/MakieOrg/Makie.jl">CairoMakie.jl</a>.</p><pre><code class="language-julia hljs"># Plot the result
times = range(0.0, 100.0, length=150)
colors = [sol(t).C[point_map] for t in times]

# Initial frame
fig = Figure()
ax = CairoMakie.Axis(fig[1,1], aspect = AxisAspect(3.0))
pmsh = mesh!(ax, plot_mesh; color=colors[1], colorrange = extrema(vcat(colors...)))
Colorbar(fig[1,2], pmsh)
framerate = 30

# Animation
record(fig, &quot;diffusion.gif&quot;, range(0.0, 100.0; length=150); framerate = 30) do t
  pmsh.color = sol(t).C[point_map]
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;diffusion.gif&quot;</code></pre><p><img src="../diffusion.gif" alt="Your first Decapode!"/></p><h2 id="Merging-Multiple-Physics"><a class="docs-heading-anchor" href="#Merging-Multiple-Physics">Merging Multiple Physics</a><a id="Merging-Multiple-Physics-1"></a><a class="docs-heading-anchor-permalink" href="#Merging-Multiple-Physics" title="Permalink"></a></h2><p>Now that we&#39;ve seen the basic pipeline, it&#39;s time for a more complex example that demonstrates some of the benefits reaped from using <a href="https://github.com/AlgebraicJulia/Catlab.jl">Catlab.jl</a> as the backend to our data structures. In this example, we will take two separate physics (diffusion and advection), and combine them together using a higher-level composition pattern.</p><p>We begin by defining the three systems we need. The first two systems are the relationships between concentration and flux under diffusion and advection respectively. The third is the relationship between the two fluxes and the change of concentration under superposition of fluxes.</p><pre><code class="language-julia hljs">Diffusion = @decapode begin
  C::Form0
  ϕ::Form1

  # Fick&#39;s first law
  ϕ ==  k(d₀(C))
end

Advection = @decapode begin
  C::Form0
  ϕ::Form1
  V::Form1

  ϕ == ∧₀₁(C,V)
end

Superposition = @decapode begin
  (C, Ċ)::Form0
  (ϕ, ϕ₁, ϕ₂)::Form1

  ϕ == ϕ₁ + ϕ₂
  Ċ == ⋆₀⁻¹(dual_d₁(⋆₁(ϕ)))
  ∂ₜ(C) == Ċ
end</code></pre><p>The diffusion Decapode.</p><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="67pt" height="215pt"
 viewBox="0.00 0.00 67.40 214.64" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 210.64)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-210.64 63.4,-210.64 63.4,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="black" cx="29.7" cy="-155.03" rx="22.76" ry="10.71"/>
<text text-anchor="middle" x="29.7" y="-151.33" font-family="Times,serif" font-size="14.00">C:Ω₀</text>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="none" stroke="black" cx="29.7" cy="-82.82" rx="29.9" ry="10.71"/>
<text text-anchor="middle" x="29.7" y="-79.12" font-family="Times,serif" font-size="14.00">•1:Ω•</text>
</g>
<!-- n1&%2345;&gt;n3 -->
<g id="edge2" class="edge">
<title>n1&%2345;&gt;n3</title>
<path fill="none" stroke="black" d="M29.7,-144.27C29.7,-132.43 29.7,-112.35 29.7,-98.6"/>
<polygon fill="black" stroke="black" points="31.45,-98.5 29.7,-93.5 27.95,-98.5 31.45,-98.5"/>
<text text-anchor="middle" x="37.2" y="-115.23" font-family="Times,serif" font-size="14.00">d₀</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="black" cx="29.7" cy="-10.61" rx="21.84" ry="10.71"/>
<text text-anchor="middle" x="29.7" y="-6.91" font-family="Times,serif" font-size="14.00">ϕ:Ω₁</text>
</g>
<!-- n3&%2345;&gt;n2 -->
<g id="edge3" class="edge">
<title>n3&%2345;&gt;n2</title>
<path fill="none" stroke="black" d="M29.7,-72.06C29.7,-60.21 29.7,-40.13 29.7,-26.39"/>
<polygon fill="black" stroke="black" points="31.45,-26.29 29.7,-21.29 27.95,-26.29 31.45,-26.29"/>
<text text-anchor="middle" x="34.2" y="-43.01" font-family="Times,serif" font-size="14.00">k</text>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
</g>
<!-- n4&%2345;&gt;n1 -->
<g id="edge1" class="edge">
<title>n4&%2345;&gt;n1</title>
<path fill="none" stroke="black" d="M29.7,-202.46C29.7,-198.14 29.7,-182.78 29.7,-170.9"/>
<polygon fill="black" stroke="black" points="31.45,-170.74 29.7,-165.74 27.95,-170.74 31.45,-170.74"/>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
</g>
</g>
</svg>
'/><p>The advection Decapode.</p><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="116pt" height="208pt"
 viewBox="0.00 0.00 115.55 208.43" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 204.43)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-204.43 111.55,-204.43 111.55,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="black" cx="22.63" cy="-148.82" rx="22.76" ry="10.71"/>
<text text-anchor="middle" x="22.63" y="-145.12" font-family="Times,serif" font-size="14.00">C:Ω₀</text>
</g>
<!-- n6 -->
<g id="node6" class="node">
<title>n6</title>
<polygon fill="none" stroke="black" points="76.63,-87.21 30.63,-87.21 30.63,-72.21 76.63,-72.21 76.63,-87.21"/>
<text text-anchor="middle" x="53.63" y="-76.01" font-family="Times,serif" font-size="14.00">Ω₀×Ω₁</text>
</g>
<!-- n1&%2345;&gt;n6 -->
<g id="edge3" class="edge">
<title>n1&%2345;&gt;n6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M26.76,-138.3C30.54,-129.63 36.34,-116.51 41.63,-105.21 43.65,-100.9 45.93,-96.19 47.96,-92.06"/>
<polygon fill="black" stroke="black" points="49.55,-92.8 50.2,-87.55 46.41,-91.25 49.55,-92.8"/>
<text text-anchor="middle" x="49.13" y="-109.01" font-family="Times,serif" font-size="14.00">π₁</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="black" cx="53.63" cy="-10.61" rx="21.84" ry="10.71"/>
<text text-anchor="middle" x="53.63" y="-6.91" font-family="Times,serif" font-size="14.00">ϕ:Ω₁</text>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="none" stroke="black" cx="85.63" cy="-148.82" rx="21.84" ry="10.71"/>
<text text-anchor="middle" x="85.63" y="-145.12" font-family="Times,serif" font-size="14.00">V:Ω₁</text>
</g>
<!-- n3&%2345;&gt;n6 -->
<g id="edge4" class="edge">
<title>n3&%2345;&gt;n6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M81.04,-138.21C75.25,-126.05 65.28,-105.14 59.09,-92.17"/>
<polygon fill="black" stroke="black" points="60.58,-91.22 56.84,-87.46 57.42,-92.73 60.58,-91.22"/>
<text text-anchor="middle" x="78.13" y="-109.01" font-family="Times,serif" font-size="14.00">π₂</text>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
</g>
<!-- n4&%2345;&gt;n1 -->
<g id="edge1" class="edge">
<title>n4&%2345;&gt;n1</title>
<path fill="none" stroke="black" d="M52.86,-196.25C49.94,-191.76 39.26,-175.36 31.42,-163.32"/>
<polygon fill="black" stroke="black" points="32.87,-162.35 28.68,-159.11 29.94,-164.26 32.87,-162.35"/>
</g>
<!-- n4&%2345;&gt;n3 -->
<g id="edge2" class="edge">
<title>n4&%2345;&gt;n3</title>
<path fill="none" stroke="black" d="M54.42,-196.25C57.44,-191.76 68.46,-175.36 76.55,-163.32"/>
<polygon fill="black" stroke="black" points="78.04,-164.24 79.38,-159.11 75.14,-162.29 78.04,-164.24"/>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
</g>
<!-- n6&%2345;&gt;n2 -->
<g id="edge5" class="edge">
<title>n6&%2345;&gt;n2</title>
<path fill="none" stroke="black" d="M53.63,-72.03C53.63,-61.5 53.63,-40.76 53.63,-26.54"/>
<polygon fill="black" stroke="black" points="55.38,-26.27 53.63,-21.27 51.88,-26.27 55.38,-26.27"/>
<text text-anchor="middle" x="64.63" y="-43.01" font-family="Times,serif" font-size="14.00">∧₀₁</text>
</g>
</g>
</svg>
'/><p>And the superposition Decapode.</p><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="181pt" height="484pt"
 viewBox="0.00 0.00 180.79 484.15" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 480.15)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-480.15 176.79,-480.15 176.79,4 -4,4"/>
<!-- n1 -->
<g id="node1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="black" cx="22.63" cy="-385.33" rx="22.76" ry="10.71"/>
<text text-anchor="middle" x="22.63" y="-381.63" font-family="Times,serif" font-size="14.00">C:Ω₀</text>
</g>
<!-- n2 -->
<g id="node2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="black" cx="38.63" cy="-51.61" rx="22.76" ry="10.71"/>
<text text-anchor="middle" x="38.63" y="-47.91" font-family="Times,serif" font-size="14.00">Ċ:Ω₀</text>
</g>
<!-- n1&%2345;&gt;n2 -->
<g id="edge8" class="edge">
<title>n1&%2345;&gt;n2</title>
<path fill="none" stroke="black" d="M22.63,-374.6C22.63,-359.7 22.63,-330.31 22.63,-305.35 22.63,-305.35 22.63,-305.35 22.63,-122.82 22.63,-103.22 28.63,-81.3 33.28,-67.25"/>
<polygon fill="black" stroke="black" points="34.96,-67.74 34.92,-62.44 31.65,-66.61 34.96,-67.74"/>
<text text-anchor="middle" x="28.63" y="-228.44" font-family="Times,serif" font-size="14.00">∂ₜ</text>
</g>
<!-- n9 -->
<g id="node9" class="node">
<title>n9</title>
</g>
<!-- n2&%2345;&gt;n9 -->
<g id="edge4" class="edge">
<title>n2&%2345;&gt;n9</title>
<path fill="none" stroke="black" d="M38.63,-40.97C38.63,-31.46 38.63,-17.21 38.63,-9.14"/>
<polygon fill="black" stroke="black" points="40.38,-9.06 38.63,-4.06 36.88,-9.06 40.38,-9.06"/>
</g>
<!-- n3 -->
<g id="node3" class="node">
<title>n3</title>
<ellipse fill="none" stroke="black" cx="99.63" cy="-268.25" rx="21.84" ry="10.71"/>
<text text-anchor="middle" x="99.63" y="-264.55" font-family="Times,serif" font-size="14.00">ϕ:Ω₁</text>
</g>
<!-- n7 -->
<g id="node7" class="node">
<title>n7</title>
<ellipse fill="none" stroke="black" cx="99.63" cy="-196.03" rx="29.9" ry="10.71"/>
<text text-anchor="middle" x="99.63" y="-192.33" font-family="Times,serif" font-size="14.00">•1:Ω•</text>
</g>
<!-- n3&%2345;&gt;n7 -->
<g id="edge5" class="edge">
<title>n3&%2345;&gt;n7</title>
<path fill="none" stroke="black" d="M99.63,-257.48C99.63,-245.64 99.63,-225.56 99.63,-211.82"/>
<polygon fill="black" stroke="black" points="101.38,-211.71 99.63,-206.71 97.88,-211.71 101.38,-211.71"/>
<text text-anchor="middle" x="107.13" y="-228.44" font-family="Times,serif" font-size="14.00">⋆₁</text>
</g>
<!-- n4 -->
<g id="node4" class="node">
<title>n4</title>
<ellipse fill="none" stroke="black" cx="76.63" cy="-424.54" rx="26.33" ry="10.71"/>
<text text-anchor="middle" x="76.63" y="-420.84" font-family="Times,serif" font-size="14.00">ϕ₁:Ω₁</text>
</g>
<!-- n10 -->
<g id="node10" class="node">
<title>n10</title>
<ellipse fill="none" stroke="black" cx="99.63" cy="-343.29" rx="13.37" ry="13.37"/>
<text text-anchor="middle" x="99.63" y="-339.59" font-family="Times,serif" font-size="14.00">Σ1</text>
</g>
<!-- n4&%2345;&gt;n10 -->
<g id="edge10" class="edge">
<title>n4&%2345;&gt;n10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M79.45,-413.82C83.22,-400.83 89.97,-377.57 94.62,-361.55"/>
<polygon fill="black" stroke="black" points="96.39,-361.71 96.11,-356.42 93.03,-360.74 96.39,-361.71"/>
</g>
<!-- n5 -->
<g id="node5" class="node">
<title>n5</title>
<ellipse fill="none" stroke="black" cx="146.63" cy="-424.54" rx="26.33" ry="10.71"/>
<text text-anchor="middle" x="146.63" y="-420.84" font-family="Times,serif" font-size="14.00">ϕ₂:Ω₁</text>
</g>
<!-- n5&%2345;&gt;n10 -->
<g id="edge11" class="edge">
<title>n5&%2345;&gt;n10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M141.05,-414.14C133.05,-400.65 118.22,-375.64 108.65,-359.5"/>
<polygon fill="black" stroke="black" points="110.15,-358.61 106.1,-355.2 107.14,-360.39 110.15,-358.61"/>
</g>
<!-- n6 -->
<g id="node6" class="node">
<title>n6</title>
<ellipse fill="none" stroke="black" cx="99.63" cy="-123.82" rx="49.49" ry="10.71"/>
<text text-anchor="middle" x="99.63" y="-120.12" font-family="Times,serif" font-size="14.00">sum_1:Ω•</text>
</g>
<!-- n6&%2345;&gt;n2 -->
<g id="edge7" class="edge">
<title>n6&%2345;&gt;n2</title>
<path fill="none" stroke="black" d="M91.4,-113.35C80.79,-101.14 62.27,-79.83 50.24,-65.97"/>
<polygon fill="black" stroke="black" points="51.32,-64.55 46.72,-61.93 48.68,-66.85 51.32,-64.55"/>
<text text-anchor="middle" x="88.63" y="-84.01" font-family="Times,serif" font-size="14.00">⋆₀⁻¹</text>
</g>
<!-- n7&%2345;&gt;n6 -->
<g id="edge6" class="edge">
<title>n7&%2345;&gt;n6</title>
<path fill="none" stroke="black" d="M99.63,-185.27C99.63,-173.43 99.63,-153.35 99.63,-139.6"/>
<polygon fill="black" stroke="black" points="101.38,-139.5 99.63,-134.5 97.88,-139.5 101.38,-139.5"/>
<text text-anchor="middle" x="125.63" y="-156.23" font-family="Times,serif" font-size="14.00">dual_d₁</text>
</g>
<!-- n8 -->
<g id="node8" class="node">
<title>n8</title>
</g>
<!-- n8&%2345;&gt;n1 -->
<g id="edge1" class="edge">
<title>n8&%2345;&gt;n1</title>
<path fill="none" stroke="black" d="M75.37,-472.1C70.41,-467.92 52.07,-451.89 41.63,-435.15 34.99,-424.5 29.99,-411.15 26.79,-401.11"/>
<polygon fill="black" stroke="black" points="28.42,-400.45 25.28,-396.19 25.07,-401.48 28.42,-400.45"/>
</g>
<!-- n8&%2345;&gt;n4 -->
<g id="edge2" class="edge">
<title>n8&%2345;&gt;n4</title>
<path fill="none" stroke="black" d="M76.63,-471.97C76.63,-467.65 76.63,-452.29 76.63,-440.41"/>
<polygon fill="black" stroke="black" points="78.38,-440.25 76.63,-435.25 74.88,-440.25 78.38,-440.25"/>
</g>
<!-- n8&%2345;&gt;n5 -->
<g id="edge3" class="edge">
<title>n8&%2345;&gt;n5</title>
<path fill="none" stroke="black" d="M78.36,-471.97C85.34,-467.22 111.96,-449.12 129.82,-436.97"/>
<polygon fill="black" stroke="black" points="131,-438.29 134.15,-434.03 129.03,-435.39 131,-438.29"/>
</g>
<!-- n10&%2345;&gt;n3 -->
<g id="edge9" class="edge">
<title>n10&%2345;&gt;n3</title>
<path fill="none" stroke="black" d="M99.63,-329.56C99.63,-316.98 99.63,-297.71 99.63,-284.35"/>
<polygon fill="black" stroke="black" points="101.38,-284.02 99.63,-279.02 97.88,-284.02 101.38,-284.02"/>
<text text-anchor="middle" x="106.13" y="-300.65" font-family="Times,serif" font-size="14.00">+</text>
</g>
</g>
</svg>
'/><p>Next, we define the pattern of composition which we want to compose these physics under. This pattern of composition is described by an undirected wiring diagram, which has the individual physics as nodes and the shared variables as the small junctions.</p><pre><code class="language-julia hljs">compose_diff_adv = @relation (C, V) begin
  diffusion(C, ϕ₁)
  advection(C, ϕ₂, V)
  superposition(ϕ₁, ϕ₂, ϕ, C)
end

draw_composition(compose_diff_adv)</code></pre><img src='data:image/svg+xml;utf-8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: G Pages: 1 -->
<svg width="607pt" height="434pt"
 viewBox="0.00 0.00 606.85 433.52" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 429.52)">
<title>G</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-429.52 602.85,-429.52 602.85,4 -4,4"/>
<!-- n1 -->
<g id="box1" class="node">
<title>n1</title>
<ellipse fill="none" stroke="black" cx="243.96" cy="-18" rx="41.41" ry="18"/>
<text text-anchor="middle" x="243.96" y="-14.3" font-family="Serif" font-size="14.00">diffusion</text>
</g>
<!-- n6 -->
<!-- junction -->
<g id="junction1" class="node">
<title>n6</title>
<ellipse fill="black" stroke="black" cx="525.85" cy="-180.75" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="517.85" y="-187.05" font-family="Serif" font-size="14.00">C</text>
</g>
<!-- n1&%2345;&%2345;n6 -->
<g id="edge1" class="edge">
<title>n1&%2345;&%2345;n6</title>
<path fill="none" stroke="black" d="M268.98,-32.44C333.39,-69.63 501.42,-166.65 523.46,-179.37"/>
</g>
<!-- n8 -->
<!-- junction -->
<g id="junction3" class="node">
<title>n8</title>
<ellipse fill="black" stroke="black" cx="431.89" cy="-18" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="421.39" y="-24.3" font-family="Serif" font-size="14.00">ϕ₁</text>
</g>
<!-- n1&%2345;&%2345;n8 -->
<g id="edge7" class="edge">
<title>n1&%2345;&%2345;n8</title>
<path fill="none" stroke="black" d="M285.2,-18C334.91,-18 413.7,-18 429.2,-18"/>
</g>
<!-- n2 -->
<g id="box2" class="node">
<title>n2</title>
<ellipse fill="none" stroke="black" cx="150" cy="-180.75" rx="45.83" ry="18"/>
<text text-anchor="middle" x="150" y="-177.05" font-family="Serif" font-size="14.00">advection</text>
</g>
<!-- n2&%2345;&%2345;n6 -->
<g id="edge2" class="edge">
<title>n2&%2345;&%2345;n6</title>
<path fill="none" stroke="black" d="M196.09,-180.75C290.18,-180.75 497.68,-180.75 523.25,-180.75"/>
</g>
<!-- n7 -->
<!-- junction -->
<g id="junction2" class="node">
<title>n7</title>
<ellipse fill="black" stroke="black" cx="75.5" cy="-180.75" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="68" y="-187.05" font-family="Serif" font-size="14.00">V</text>
</g>
<!-- n2&%2345;&%2345;n7 -->
<g id="edge5" class="edge">
<title>n2&%2345;&%2345;n7</title>
<path fill="none" stroke="black" d="M103.67,-180.75C92.54,-180.75 82.56,-180.75 78.05,-180.75"/>
</g>
<!-- n9 -->
<!-- junction -->
<g id="junction4" class="node">
<title>n9</title>
<ellipse fill="black" stroke="black" cx="243.96" cy="-343.5" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="233.46" y="-349.8" font-family="Serif" font-size="14.00">ϕ₂</text>
</g>
<!-- n2&%2345;&%2345;n9 -->
<g id="edge9" class="edge">
<title>n2&%2345;&%2345;n9</title>
<path fill="none" stroke="black" d="M160.23,-198.48C182.5,-237.03 234.02,-326.27 242.71,-341.32"/>
</g>
<!-- n3 -->
<g id="box3" class="node">
<title>n3</title>
<ellipse fill="none" stroke="black" cx="431.89" cy="-343.5" rx="62.3" ry="18"/>
<text text-anchor="middle" x="431.89" y="-339.8" font-family="Serif" font-size="14.00">superposition</text>
</g>
<!-- n3&%2345;&%2345;n6 -->
<g id="edge3" class="edge">
<title>n3&%2345;&%2345;n6</title>
<path fill="none" stroke="black" d="M442.31,-325.46C464.48,-287.06 515.08,-199.41 524.37,-183.31"/>
</g>
<!-- n3&%2345;&%2345;n8 -->
<g id="edge8" class="edge">
<title>n3&%2345;&%2345;n8</title>
<path fill="none" stroke="black" d="M431.89,-325.07C431.89,-260.51 431.89,-47.11 431.89,-20.69"/>
</g>
<!-- n3&%2345;&%2345;n9 -->
<g id="edge10" class="edge">
<title>n3&%2345;&%2345;n9</title>
<path fill="none" stroke="black" d="M369.31,-343.5C321.05,-343.5 260.31,-343.5 246.74,-343.5"/>
</g>
<!-- n10 -->
<!-- junction -->
<g id="junction5" class="node">
<title>n10</title>
<ellipse fill="black" stroke="black" cx="469.14" cy="-408.02" rx="2.5" ry="2.5"/>
<text text-anchor="middle" x="461.64" y="-414.32" font-family="Serif" font-size="14.00">ϕ</text>
</g>
<!-- n3&%2345;&%2345;n10 -->
<g id="edge11" class="edge">
<title>n3&%2345;&%2345;n10</title>
<path fill="none" stroke="black" d="M442.27,-361.47C451.39,-377.28 463.83,-398.83 467.84,-405.77"/>
</g>
<!-- n4 -->
<!-- n4&%2345;&%2345;n6 -->
<g id="edge4" class="edge">
<title>n4&%2345;&%2345;n6</title>
<path fill="none" stroke="black" d="M597.54,-180.75C590.57,-180.75 540.91,-180.75 528.61,-180.75"/>
</g>
<!-- n5 -->
<!-- n5&%2345;&%2345;n7 -->
<g id="edge6" class="edge">
<title>n5&%2345;&%2345;n7</title>
<path fill="none" stroke="black" d="M1.34,-180.75C8.62,-180.75 60.84,-180.75 72.98,-180.75"/>
</g>
</g>
</svg>
'/><p>After this, the physics can be composed as follows:</p><pre><code class="language-julia hljs">DiffusionAdvection_cospan = oapply(compose_diff_adv,
                  [Open(Diffusion, [:C, :ϕ]),
                   Open(Advection, [:C, :ϕ, :V]),
                   Open(Superposition, [:ϕ₁, :ϕ₂, :ϕ, :C])])
DiffusionAdvection = apex(DiffusionAdvection_cospan)

to_graphviz(DiffusionAdvection)</code></pre><img src="4690d045.svg" alt="Example block output"/><p>Similar to before, this physics can be compiled and executed. Note that this process now requires another value to be defined, namely the velocity vector field. We do this using a custom operator called <code>flat_op</code>. This operator is basically the flat operator from CombinatorialSpaces.jl, but specialized to account for the periodic mesh.</p><p>We could instead represent the domain as the surface of an object with equivalent boundaries in 3D.</p><pre><code class="language-julia hljs">using LinearAlgebra
using MLStyle

function generate(sd, my_symbol; hodge=DiagonalHodge())
  op = @match my_symbol begin
    :k =&gt; x -&gt; 0.05*x
    x =&gt; error(&quot;Unmatched operator $my_symbol&quot;)
  end
  return (args...) -&gt; op(args...)
end

sim = eval(gensim(DiffusionAdvection))
fₘ = sim(periodic_mesh, generate, DiagonalHodge())

velocity(p) = [-0.5, -0.5, 0.0]
v = flat_op(periodic_mesh, DualVectorField(velocity.(periodic_mesh[triangle_center(periodic_mesh),:dual_point])); dims=[30, 10, Inf])

u₀ = ComponentArray(C=c,V=v)

prob = ODEProblem(fₘ, u₀, (0.0, 100.0))
sol = solve(prob, Tsit5());

# Plot the result
times = range(0.0, 100.0, length=150)
colors = [sol(t).C[point_map] for t in times]

# Initial frame
fig = Figure()
ax = CairoMakie.Axis(fig[1,1], aspect = AxisAspect(3.0))
pmsh = mesh!(ax, plot_mesh; color=colors[1], colorrange = extrema(vcat(colors...)))
Colorbar(fig[1,2], pmsh)
framerate = 30

# Animation
record(fig, &quot;diff_adv.gif&quot;, range(0.0, 100.0; length=150); framerate = 30) do t
  pmsh.color = sol(t).C[point_map]
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">&quot;diff_adv.gif&quot;</code></pre><p><img src="../diff_adv.gif" alt="Your first composed Decapode!"/></p><pre class="documenter-example-output"><code class="nohighlight hljs ansi">[ Info: Page built in 36 seconds.
[ Info: This page was last built at 2024-08-21T00:12:43.288.</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« Decapodes.jl</a><a class="docs-footer-nextpage" href="../../equations/equations/">Equations »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.6.0 on <span class="colophon-date" title="Wednesday 21 August 2024 00:13">Wednesday 21 August 2024</span>. Using Julia version 1.10.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
